{{- $architecture := or .architecture "arm64" -}}

architecture: {{ $architecture }}

actions:
  - action: run
    chroot: true
    command: |
      wget https://github.com/Sirr-OS/plymouth-theme-sirros/releases/download/main/plymouth-theme-sirros_1.1_all.deb
      dpkg -i plymouth-theme-sirros_1.1_all.deb 
      rm -f plymouth-theme-sirros_1.1_all.deb 
      plymouth-set-default-theme -R sirros

  - action: run
    chroot: true
    command: |
      wget https://github.com/Sirr-OS/sirros-theme/releases/download/latest/theme-sirros-v1.0.0.deb
      dpkg -i theme-sirros-v1.0.0.deb
      rm -f theme-sirros-v1.0.0.deb

  - action: run
    chroot: true
    description: Divert os-release and install SirrOS details
    command: |
      # Create a fork to protecte original file 
      dpkg-divert --divert /usr/lib/os-release.distrib --rename /usr/lib/os-release

      # Write OS-Release Custom 
      cat << 'EOF' > /usr/lib/os-release
      NAME="SirrOS"
      PRETTY_NAME="SirrOS Phosh Edition"
      ID=Sirros
      VERSION="1.0"
      HOME_URL="https://github.com/commander-Z3R0/Sirr-OS"
      EOF

  - action: run
    chroot: true
    description: Remove Background Blobs
    command: |
      rm /usr/share/backgrounds/gnome/blobs-d.svg /usr/share/backgrounds/gnome/blobs-l.svg	  
